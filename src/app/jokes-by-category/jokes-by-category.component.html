<div class="category">

    <h2>{{jokeCategory?.description}}</h2>

    <img class="category-thumbnail" [src]="jokeCategory?.iconUrl">

    <fieldset>
        <legend>Search Options</legend>
        <section class="example-section" [formGroup]="jokeFlags"
            style="display: flex; justify-content: space-around; align-items: baseline;">
            <h3>Blacklist Flags:</h3>

            <span class="example-list-section">
                <mat-checkbox class="example-margin" style="font-weight: bold;" [checked]="allFlagsChecked"
                    [indeterminate]="someFlagsChecked()" (change)="setAllFlags($event.checked)">
                    <span [innerHTML]="allFlagsChecked?'Clear All':'Select All'"></span>
                </mat-checkbox>
            </span>

            <span *ngFor="let option of flagOptions">
                <mat-checkbox [(ngModel)]="option.checked" [formControlName]=option.name
                    (ngModelChange)="flagsTrigger()">{{
                    option.name }}</mat-checkbox>
            </span>
        </section>

        <section class="example-section">
            <button mat-button class="mat-raised-button mat-primary" style="background-color: #7e3399;"
                (click)="loadJokes(this.jokeCategory.description, this.activeFlags);">
                Search New Jokes
            </button>
        </section>

    </fieldset>

    <mat-form-field appearance="fill" style="display: flex; justify-content: end;">
        <mat-label>Filter Table By Flags</mat-label>
        <mat-select [formControl]="flagsForTableFilter" multiple>
            <mat-option *ngFor="let option of flagOptions" [value]="option.name">{{option.name}}</mat-option>
        </mat-select>
    </mat-form-field>


    <div class="spinner-div-container">
        <span class="spinner-container" *ngIf="loading">
            <mat-spinner></mat-spinner>
        </span>
    </div>

    <mat-table class="jokes-table mat-elevation-z8" [dataSource]="sortedJokes | tableFilter" matSort
        matSortActive="category" matSortDirection="asc" matSortDisableClear (matSortChange)="sortData($event)">

        <ng-container matColumnDef="category">
            <mat-header-cell *matHeaderCellDef mat-sort-header="category">Category</mat-header-cell>
            <mat-cell *matCellDef="let joke">{{joke.category}}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="joke">
            <mat-header-cell *matHeaderCellDef>Joke</mat-header-cell>
            <mat-cell class="description-cell" *matCellDef="let joke">{{joke.joke}}</mat-cell>
        </ng-container>

        <ng-container matColumnDef="flags">
            <mat-header-cell *matHeaderCellDef>Flags</mat-header-cell>
            <mat-cell class="duration-cell" *matCellDef="let joke">{{joke.flags | activeFlags}}</mat-cell>
        </ng-container>

        <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>

        <mat-row *matRowDef="let row; columns: displayedColumns"></mat-row>

    </mat-table>

</div>